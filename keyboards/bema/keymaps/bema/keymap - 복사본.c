
#include QMK_KEYBOARD_H


#define U_NP KC_NO // key is not present
#define U_NA KC_NO // present but not available for use
#define U_NU KC_NO // available but not used

uint16_t get_tapping_term(uint16_t keycode, keyrecord_t *record) {
    switch (keycode) {
        case LSFT_T(KC_F):
            return 200;
        case LSFT_T(KC_J):
            return 130;
        case LCTL_T(KC_D):
            return 250;
        case LCTL_T(KC_K):
            return 250;
        case LALT_T(KC_S):
            return 250;
        case LALT_T(KC_L):
            return 250;
        case LGUI_T(KC_A):
            return 300;
        case LGUI_T(KC_COLN):
            return 300;
        default:
            return TAPPING_TERM;
    }
}

enum {
    CT_SE,
    CT_CLN,
    CT_DEL,
    CT_EGG,
    CT_FLSH,
    X_TAP_DANCE
};

void dance_cln_finished(qk_tap_dance_state_t *state, void *user_data) {
    if (state->count == 1) {
        register_code16(KC_COLN);
    } else {
        register_code(KC_SCLN);
    }
}

void dance_cln_reset(qk_tap_dance_state_t *state, void *user_data) {
    if (state->count == 1) {
        unregister_code16(KC_COLN);
    } else {
        unregister_code(KC_SCLN);
    }
}

// All tap dance functions would go here. Only showing this one.
qk_tap_dance_action_t tap_dance_actions[] = {
    [CT_SE] = ACTION_TAP_DANCE_FN_ADVANCED(NULL, dance_cln_finished, dance_cln_reset),
    [CT_CLN] = ACTION_TAP_DANCE_DOUBLE(KC_MINS, KC_UNDS),
    [CT_DEL] = ACTION_TAP_DANCE_DOUBLE(KC_DEL, KC_ALGR)
};

enum layers { BASE, BUTTON, MEDIA, NAV, MOUSE, SYM, NUM, FUN };


#define U_RDO C(KC_Y)
#define U_PST C(KC_V)
#define U_CPY C(KC_C)
#define U_CUT C(KC_X)
#define U_UND C(KC_Z)
#define U_ALL C(KC_A)



const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  [BASE] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                    KC_Q,               KC_W,               KC_E,               KC_R,               KC_T,                                                       KC_Y,               KC_U,               KC_I,               KC_O,               KC_P,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
            LGUI_T(KC_A),       LALT_T(KC_S),       LCTL_T(KC_D),       LSFT_T(KC_F),               KC_G,                                                       KC_H,       LSFT_T(KC_J),       LCTL_T(KC_K),       LALT_T(KC_L),    LGUI_T(KC_COLN), 
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                    KC_Z,       ALGR_T(KC_X),               KC_C,               KC_V,               KC_B,                                                       KC_N,               KC_M,            KC_COMM,     ALGR_T(KC_DOT),LT(BUTTON, KC_SLSH),
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                   LT(MEDIA, KC_ESC),    LT(NAV, KC_TAB),   LT(MOUSE, KC_SPC),    LT(SYM, KC_BSPC),  LT(NUM, KC_ENT),    LT(FUN, KC_DEL)
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),


  [BUTTON] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                      U_RDO,              U_PST,              U_CPY,              U_CUT,              U_UND,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                 KC_LGUI,            KC_LALT,            KC_LCTL,            KC_LSFT,            KC_TRNS,                                                    KC_TRNS,            KC_LSFT,            KC_LCTL,            KC_LALT,            KC_LGUI,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                       S  |-----------------+-------------------+-------------------+-------------------+------------------|
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                      U_RDO,              U_PST,              U_CPY,              U_CUT,              U_UND,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                              KC_ESC,             KC_TAB,              KC_SPC,             KC_BSPC,           KC_ENT,             KC_DEL
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [MEDIA] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                    U_NA,            KC_HOME,              KC_UP,             KC_END,            KC_PGUP,                                                    RGB_TOG,            RGB_MOD,            RGB_HUI,            RGB_SAI,            RGB_VAI,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                 KC_CAPS,            KC_LEFT,            KC_DOWN,            KC_RGHT,            KC_PGDN,                                                       U_NA,            KC_MPRV,            KC_VOLD,            KC_VOLU,            KC_MNXT,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                       U_NA,               U_NA,               U_NA,               U_NA,              RESET,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                                U_NA,               U_NA,                U_NA,             KC_MSTP,          KC_MPLY,            KC_MUTE
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [NAV] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                    KC_PGUP,            KC_HOME,              KC_UP,             KC_END,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                   U_ALL,            KC_LALT,            KC_LCTL,            KC_LSFT,               U_NA,                                                    KC_PGDN,            KC_LEFT,            KC_DOWN,            KC_RGHT,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                      U_RDO,              U_PST,              U_CPY,              U_CUT,              U_UND,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                              KC_ESC,             KC_TAB,              KC_SPC,             KC_BSPC,           KC_ENT,             KC_DEL
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [MOUSE] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                    KC_WH_U,            KC_WH_L,            KC_MS_U,            KC_WH_R,            KC_BTN4,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                   U_ALL,            KC_LALT,            KC_LCTL,            KC_LSFT,               U_NA,                                                    KC_WH_D,            KC_MS_L,            KC_MS_D,            KC_MS_R,            KC_BTN5,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                   U_UND,              U_CUT,              U_CPY,              U_PST,              U_RDO,                                                      U_RDO,              U_PST,              U_CPY,              U_CUT,              U_UND,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                                U_NA,               U_NA,                U_NA,             KC_BTN1,          KC_BTN2,            KC_BTN3
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [SYM] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                 KC_LCBR,            KC_AMPR,            KC_ASTR,            KC_LPRN,            KC_RCBR,                                                       U_NA,               U_NA,               U_NA,               U_NA,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                 KC_DQUO,             KC_DLR,            KC_PERC,            KC_CIRC,            KC_PLUS,                                                       U_NA,            KC_LSFT,            KC_LCTL,            KC_LALT,            KC_LGUI,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                 KC_TILD,            KC_EXLM,              KC_AT,            KC_HASH,            KC_PIPE,                                                       U_NA,               U_NA,               U_NA,            KC_ALGR,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                             KC_LPRN,            KC_RPRN,             KC_UNDS,                U_NA,             U_NA,               U_NA
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [NUM] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                    KC_LBRC,            KC_7,               KC_8,               KC_9,            KC_RBRC,                                                       U_NA,               U_NA,               U_NA,               U_NA,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                    KC_QUOTE,           KC_4,               KC_5,               KC_6,             KC_EQL,                                                       U_NA,            KC_LSFT,            KC_LCTL,            KC_LALT,            KC_LGUI,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                    KC_GRV,             KC_1,               KC_2,               KC_3,            KC_BSLS,                                                       U_NA,               U_NA,               U_NA,            KC_ALGR,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                              KC_DOT,               KC_0,             KC_MINS,                U_NA,             U_NA,               U_NA
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  ),

  [FUN] = LAYOUT_split_3x5_3(
  //,---------------------------------------------------------------------------------------------------.                                         ,-------------------------------------------------------------------------------------------------.
                  KC_F12,              KC_F7,              KC_F8,              KC_F9,            KC_PSCR,                                                       U_NA,               U_NA,               U_NA,               U_NA,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                  KC_F11,              KC_F4,              KC_F5,              KC_F6,            KC_SLCK,                                                       U_NA,            KC_LSFT,            KC_LCTL,            KC_LALT,            KC_LGUI,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                  KC_F10,              KC_F1,              KC_F2,              KC_F3,            KC_PAUS,                                                       U_NA,               U_NA,               U_NA,            KC_ALGR,               U_NA,
  //|-------------------+-------------------+-------------------+-------------------+-------------------|                                         |-----------------+-------------------+-------------------+-------------------+-------------------|
                                                                              KC_APP,             KC_TAB,              KC_SPC,             KC_BSPC,           KC_ENT,             KC_DEL
  //                                                            |-------------------+-------------------+--------------------+--------------------+-----------------+-------------------|
  )
};

